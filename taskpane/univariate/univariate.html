<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Univariate Analysis</title>
    
    <!-- Office.js -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />
    
    <!-- Light Minimal Taskpane CSS -->
    <link rel="stylesheet" href="../../src/shared/css/taskpane-light.css">
    
    <!-- Data Input Panel CSS -->
    <link rel="stylesheet" href="../../src/shared/css/data-input-panel.css">
</head>
<body>
    <div class="taskpane-container">
        <!-- Header -->
        <div class="module-header">
            <div class="module-header-title">
                <i class="fa-solid fa-chart-simple"></i>
                Univariate
            </div>
            <button class="back-btn" onclick="goBack()">
                <i class="fa-solid fa-arrow-left"></i>
                Back
            </button>
        </div>

        <!-- Results Theme Selector -->
        <div class="panel-section" style="margin-bottom: 12px;">
            <div class="section-title" style="font-size: 12px; margin-bottom: 8px;">
                <i class="fa-solid fa-palette"></i>
                Results Style
            </div>
            <div style="display: flex; gap: 8px; padding: 0 12px;">
                <button id="themeLight" class="theme-btn active" onclick="setResultsTheme('light')" title="Modern light theme with clean aesthetics">
                    <i class="fa-solid fa-sun"></i>
                    <span>Light</span>
                </button>
                <button id="themeDark" class="theme-btn" onclick="setResultsTheme('dark')" title="Classic dark theme with rich colors">
                    <i class="fa-solid fa-moon"></i>
                    <span>Dark</span>
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="taskpane-content">
            <!-- Data Input Panel -->
            <div id="dataInputContainer"></div>

            <!-- Variable Selection -->
            <div class="section">
                <div class="section-header">
                    <i class="fa-solid fa-table-columns"></i>
                    <span class="section-title">Column</span>
                </div>
                <div class="section-body">
                    <select id="ddlVariable">
                        <option value="">Select column to analyze</option>
                    </select>
                </div>
            </div>

            <!-- Tabs -->
            <div class="section">
                <div class="tabs">
                    <button id="tab-summary" class="tab-btn active" onclick="switchTab('summary')">Summary</button>
                    <button id="tab-trim" class="tab-btn disabled" onclick="switchTab('trim')">Trim</button>
                    <button id="tab-transform" class="tab-btn disabled" onclick="switchTab('transform')">Transform</button>
                </div>
                <div class="tab-content">
                    <!-- Summary -->
                    <div id="panel-summary" class="active">
                        <div id="summaryContent" class="hint">
                            <i class="fa-solid fa-info-circle"></i><br>
                            Select a data range and column
                        </div>
                    </div>

                    <!-- Trim -->
                    <div id="panel-trim" style="display: none;">
                        <div class="field-group">
                            <label class="field-label">Left Trim</label>
                            <input id="slMin" type="range" min="0" max="100" value="0" step="1" />
                            <div id="lblMin" class="hint">—</div>
                        </div>
                        <div class="field-group">
                            <label class="field-label">Right Trim</label>
                            <input id="slMax" type="range" min="0" max="100" value="100" step="1" />
                            <div id="lblMax" class="hint">—</div>
                        </div>
                        <button class="btn-primary" onclick="resetTrim()" style="margin-top: 8px; padding: 8px; font-size: 11px;">
                            <i class="fa-solid fa-arrow-rotate-left"></i>
                            Reset
                        </button>
                    </div>

                    <!-- Transform -->
                    <div id="panel-transform" style="display: none;">
                        <div id="radTransforms" style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="none" checked />
                                <span>None</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="ln" />
                                <span>ln(x)</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="log10" />
                                <span>log10(x)</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="sqrt" />
                                <span>√x</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="square" />
                                <span>x²</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="reciprocal" />
                                <span>1/x</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="z" />
                                <span>z-score</span>
                            </label>
                            <label class="checkbox-group" style="margin: 0;">
                                <input type="radio" name="transform" value="minmax" />
                                <span>Min-Max</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="section">
                <div class="section-header">
                    <i class="fa-solid fa-calculator"></i>
                    <span class="section-title">Quick Stats</span>
                </div>
                <div class="section-body">
                    <div class="stats-mini">
                        <div class="stat-box">
                            <div class="stat-label">n</div>
                            <div class="stat-value" id="stat-n">—</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Mean</div>
                            <div class="stat-value" id="stat-mean">—</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Median</div>
                            <div class="stat-value" id="stat-median">—</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">SD</div>
                            <div class="stat-value" id="stat-std">—</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Min</div>
                            <div class="stat-value" id="stat-min">—</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Max</div>
                            <div class="stat-value" id="stat-max">—</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Run Button -->
            <button class="btn-primary" id="runButton" onclick="runAnalysis()">
                <i class="fa-solid fa-play"></i>
                Run Full Analysis
            </button>
            
            <!-- Quick Test Buttons (for development) -->
            <div style="display: flex; gap: 8px; margin-top: 8px;">
                <button class="btn-secondary" onclick="quickTestHistogram()" title="Quick test with sample data">
                    <i class="fa-solid fa-chart-column"></i>
                    Test Histogram
                </button>
                <button class="btn-secondary" onclick="quickTestBoxPlot()" title="Quick test with sample data">
                    <i class="fa-solid fa-box"></i>
                    Test Box Plot
                </button>
                <button class="btn-secondary" onclick="quickTestQQPlot()" title="Quick test with sample data">
                    <i class="fa-solid fa-chart-scatter"></i>
                    Test QQ/PP Plot
                </button>
            </div>

            <!-- Status -->
            <div class="status-msg" id="statusMessage"></div>
        </div>
    </div>

    <!-- Shared Data Input Panel JS -->
    <script src="../../src/shared/js/components/DataInputPanel.js"></script>
    
    <!-- Module Logic -->
    <script src="univariate.js"></script>
</body>
</html>
