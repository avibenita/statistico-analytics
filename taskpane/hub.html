<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analytics Hub</title>
  
  <!-- Office.js -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
  
  <!-- Light Minimal Taskpane CSS -->
  <link rel="stylesheet" href="../src/shared/css/taskpane-light.css" />
</head>
<body>
  <div class="hub-container">
    <!-- Header -->
    <div class="hub-header">
      <div class="hub-title">
        <i class="fa-solid fa-chart-line"></i>
        Statistico Analytics
      </div>
      <div class="hub-subtitle">Select an analysis module</div>
    </div>

    <!-- Module Grid -->
    <div class="modules-grid" id="modulesList">
      <div class="loading">
        <div class="spinner-sm"></div>
        <div>Loading modules...</div>
      </div>
    </div>
  </div>

  <script>
    Office.onReady((info) => {
      if (info.host === Office.HostType.Excel) {
        initializeHub();
      } else {
        showError('This add-in is designed for Excel only.');
      }
    });

    function initializeHub() {
      const container = document.getElementById('modulesList');
      
      const modules = [
        {
          id: 'univariate',
          icon: 'fa-chart-simple',
          name: 'Univariate',
          description: 'Descriptive stats, distribution, and normality'
        },
        {
          id: 'correlations',
          icon: 'fa-diagram-project',
          name: 'Correlations',
          description: 'Pearson, Spearman, and partial correlations'
        },
        {
          id: 'regression',
          icon: 'fa-chart-line',
          name: 'Regression',
          description: 'OLS with diagnostics and predictions'
        },
        {
          id: 'anova',
          icon: 'fa-table-cells',
          name: 'ANOVA',
          description: 'One-way, two-way, and factorial designs'
        },
        {
          id: 'logistic',
          icon: 'fa-percent',
          name: 'Logistic Regression',
          description: 'Binary and multinomial classification'
        },
        {
          id: 'factor',
          icon: 'fa-cubes',
          name: 'Factor Analysis',
          description: 'EFA, PCA, and dimension reduction'
        }
      ];

      container.innerHTML = modules.map(module => `
        <div class="module-card" onclick="navigateToModule('${module.id}')">
          <div class="module-icon">
            <i class="fa-solid ${module.icon}"></i>
          </div>
          <div class="module-name">${module.name}</div>
          <div class="module-description">${module.description}</div>
        </div>
      `).join('');
    }

    function navigateToModule(moduleName) {
      console.log('üìç Navigating to:', moduleName);
      window.location.href = `./${moduleName}/${moduleName}.html`;
    }

    function showError(message) {
      const container = document.getElementById('modulesList');
      container.innerHTML = `
        <div class="loading">
          <i class="fa-solid fa-exclamation-triangle" style="color: #ef4444; font-size: 32px; margin-bottom: 12px;"></i>
          <div style="color: #ef4444;">${message}</div>
        </div>
      `;
    }

    window.navigateToModule = navigateToModule;
  </script>
</body>
</html>
