<!-- 
  ================================================================
  SHARED DATA INPUT PANEL COMPONENT
  ================================================================
  Common data selection interface for all Statistico Analytics modules
  - Named Range with dropdown
  - Used Range (auto-detect)
  - Use Selection (from current Excel selection)
  
  Usage: Include this file in your module HTML and call initDataInputPanel()
  ================================================================
-->

<div class="panel-section" id="dataInputPanel">
  <div class="section-title">
    <i class="fa-solid fa-database"></i> PICK DATA RANGE
  </div>
  
  <!-- 3 Buttons in One Row -->
  <div style="display: flex; gap: 8px; margin-bottom: 12px; position: relative;">
    
    <!-- Button 1: Named Range (with dropdown) -->
    <div style="flex: 1; position: relative;">
      <button id="namedRangeBtn" class="range-btn" onclick="toggleNamedRangeDropdown()" style="width: 100%;" data-tooltip="Load data from a named range in Excel">
        <i class="fa-solid fa-bookmark"></i>
        <span>Named Range</span>
        <i class="fa-solid fa-chevron-down" style="margin-left: auto; font-size: 10px;"></i>
      </button>
      <div id="namedRangeDropdown" class="range-dropdown" style="display: none;">
        <div style="padding: 8px; font-size: 11px; color: var(--text-muted); border-bottom: 1px solid var(--border);">
          Select a named range:
        </div>
        <select id="rangeSelector" onchange="loadFromNamedRange()" size="5" style="width: 100%; border: none; background: var(--surface-1); color: var(--text-primary); padding: 4px; font-size: 11px; outline: none;">
          <option value="" style="color: var(--text-muted);">-- No selection --</option>
        </select>
      </div>
    </div>
    
    <!-- Button 2: Auto-detect -->
    <button id="autoDetectBtn" class="range-btn" onclick="autoDetectRange()" style="flex: 1;" data-tooltip="Automatically detect continuous data around the active cell">
      <i class="fa-solid fa-magic"></i>
      <span>Used Range</span>
    </button>
    
    <!-- Button 3: Selected Range -->
    <button id="useSelectionBtn" class="range-btn" onclick="useSelection()" style="flex: 1;" disabled data-tooltip="Load data from the currently selected cells in Excel">
      <i class="fa-solid fa-check"></i>
      <span>Use Selection</span>
    </button>
    
  </div>
  
  <!-- Unified Range Display -->
  <div id="rangeDisplay" style="display: none; background: var(--surface-2); border: 1px solid var(--accent-1); border-radius: 6px; padding: 10px; margin-bottom: 12px; font-size: 11px;">
    <div style="color: var(--accent-1); font-weight: 600; margin-bottom: 6px;">
      <i id="rangeIcon" class="fa-solid fa-bookmark"></i> <span id="rangeTitle"></span>
    </div>
    <div style="color: var(--text-muted); font-size: 10px;">
      <span id="rangeDetails"></span>
    </div>
  </div>
</div>
